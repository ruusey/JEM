<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>JEM Home</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">

	<!-- Le styles -->
	<link href="css/jquery.contextMenu.css" rel="stylesheet">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
	 crossorigin="anonymous">
	<link href="css/n2styles.css" rel="stylesheet">
	<link href="css/jquery-ui.css" rel="stylesheet">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU"
	 crossorigin="anonymous">
	<link href="css/bootstrap-responsive.css" rel="stylesheet">
	<link href="css/uploadfile.css" rel="stylesheet">
	<link href="css/toastr.css" rel="stylesheet">
	<link rel="stylesheet" href="css/owl.carousel.css">
	<link rel="stylesheet" href="css/owl.theme.default.css">


	<link rel="icon" href="img/gem.png" type="image/png" />
	<script src="js/jquery.js"></script>
	<script src="js/handlebars-latest.js"></script>
	<script src="js/popper.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/jquery.geolocation.js"></script>
	<script src="js/jquery.rest.js"></script>
	<script src="js/underscore.js"></script>
	<script src="js/backbone.js"></script>
	<script src="js/jquery.cookie.js"></script>
	<script src="js/jquery-ui.js"></script>
	<!-- [if lte IE 8]><script src="js/flot/excanvas.min.js"></script><![endif]-->
	<script src="js/toastr.js"></script>
	<script src="js/jquery.contextMenu.js"></script>
	<script src="js/jquery.ui.position.js"></script>

	<script src="js/owl.carousel.js"></script>
	<style>
		/* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
</head>

<body>
	<div class="container">

		<nav class="navbar navbar-expand-lg navbar-light bg-light">
			<i class="fas fa-gem fa-2x float-left"></i>
			<a class="navbar-brand" href="#">&nbsp;GEM</a>

			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
			 aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav mr-auto w-75">
					<li class="nav-item active">
						<a class="nav-link" href="#">Home
							<span class="sr-only">(current)</span>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="docs">Docs</a>
					</li>
					<li class="nav-item dropdown w-50">
						<a id="login-link" class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
						 aria-haspopup="true" aria-expanded="false">
							Login
						</a>
						<ul id="login-dropdown" class="dropdown-menu w-100" role="menu">
							<li class="dropdown-submenu">
								<h6 class="dropdown-header">Service Provider Login</h6>
							<li class="p-4">

								<form autocomplete="off">
									<div class="form-group col-med">
										<label for="exampleDropdownFormEmail1">Email Or Username</label>
										<input autocomplete="false" type="email" class="form-control" id="exampleDropdownFormEmail1" placeholder="email/username">
									</div>
									<div class="form-group col-med">
										<label for="exampleDropdownFormPassword1">Password</label>
										<input autocomplete="false" type="password" class="form-control" id="exampleDropdownFormPassword1"
										 placeholder="Password">
									</div>

									<button id="fetch-data-submit" type="button" class="btn btn-primary">Sign in</button>
								</form>

							</li>

					</li>
				</ul>
				</li>
				<li class="nav-item">
					<a id="geoloc" class="nav-link" href="#">Get Location</a>
				</li>
				<li class="nav-item">
					<button id="sync-service" type="button" class="btn btn-primary">Sync</button>
				</li>
				</ul>
			</div>
			<div id="server-time-container" class="col-sm">


			</div>


		</nav>


	</div>
	<div id="client-data" class="container-fluid">


	</div>
	<script type="text/x-handlebars-template" id="server-time-template">
					{{#if timestamp}}
						<span id = "server-time" class="badge badge-secondary float-right">
							{{timestamp}}
						</span>
					{{/if}}
				<i id=server-status" class="fas fa-circle float-right" style="color:green"></i>
			</script>
	<hr>
	<script id="entry-template" type="text/x-handlebars-template">

	  <div class='bg-info p-3 text-white row justify-content-md-center'>
		  <div class='col col-lg-4'><i id="edit-service-provider" class="fa fa-cog fa-2x" style="vertical-align: middle; color:white; float:right;">&nbsp;</i></div>
	  		<div class="col col-lg-1 h5"><i class="fa fa-user-circle fa-2x" style=" vertical-align: middle;">&nbsp;</i>{{userName}}</div>
			<div class="col col-lg-1 h5"><i class="fa fa-id-badge fa-2x" style=" vertical-align: middle;" aria-hidden="true">&nbsp;</i>{{firstName}}, {{lastName}}</div>
			<div class="col col-lg-1 h5"><i class="fa fa-envelope fa-2x" style=" vertical-align: middle;" aria-hidden="true">&nbsp;</i>{{email}}</div>
			<div class='col col-lg-4'></div>
				<div class='bg-success p-3 text-white row justify-content-md-center'>
					<div class='col col-lg-2'></div>
					<div class="col col-lg h5"><i class="fa fa-star" style=" vertical-align: middle;" aria-hidden="true">&nbsp;</i>Rating<br>{{rating}}</div>
					<div class="col col-lg h5">{{loc.lat}} {{loc.lng}}</div>
					<div class='col col-lg-2'></div>
				</div>
			
				
		</div>
		<hr>
		<div class='p-2 ml-2 bg-light text-white text-center row justify-content-md-center col col-4'>
			
			<div ><h3 class='p-2 mb-2 text-white bg-info'>Your Services</h3>
			
			<ul class='row justify-content-md-center list-group'>
				{{#each services}}
					<li class='list-group-item text-center d-flex justify-content-between align-items-center text-info'>
						{{.}}
					</li>
				{{~/each}}
				</ul>
			</div>	
		</div>
		
	
	</script>
	<div class="fixed-bottom bg-gray text-gray text-center justify-content-md-center">
		<h5 class="text-muted">
			This website uses cookies, deal with it.
			<br>
			<small class="text-muted"><span class="fa fa-copyright fa-2x" style=" vertical-align: middle;">&nbsp;</span> Robert
				Usey 2018</small>
		</h5>

	</div>
	<div id="map"></div>


	<script src="js/jem.js"></script>
	<script src="js/jemimpl.js"></script>
	<script>
		// Note: This example requires that you consent to location sharing when
		// prompted by your browser. If you see the error "The Geolocation service
		// failed.", it means you probably did not give permission for the browser to
		// locate you.
		function initMap() {
			var sp = spCollection.get(1);
			var loc = new SPGeoLocModel();
			var locString;
			loc.set("id", sp.get("id"));

			var map = new google.maps.Map(document.getElementById('map'), {
				center: { lat: sp.get("loc").lat, lng: sp.get("loc").lng },
				zoom: 10
			});
			var geocoder = new google.maps.Geocoder;
			var infoWindow = new google.maps.InfoWindow;
			write(locString)
			// Try HTML5 geolocation.
			if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(function (position) {
					var pos = {
						lat: position.coords.latitude,
						lng: position.coords.longitude
					};
					loc.fetch({
						dataType: "text",
						success: function (res, xhr, response) {

							locString = response.xhr.responseText;
							infoWindow.setContent(locString);
						}
					});
					infoWindow.setPosition(pos);

					infoWindow.open(map);
					map.setCenter(pos);
				}, function () {
					handleLocationError(true, infoWindow, map.getCenter());
				});
			} else {
				// Browser doesn't support Geolocation
				handleLocationError(false, infoWindow, map.getCenter());
			}
		}
		function geocodeLatLng(geocoder, map, infowindow) {
			var latlng = { lat: sp.get("loc").lat, lng: sp.get("loc").lng };
			geocoder.geocode({ 'location': latlng }, function (results, status) {
				if (status === 'OK') {
					if (results[0]) {
						map.setZoom(11);
						var marker = new google.maps.Marker({
							position: latlng,
							map: map
						});
						infowindow.setContent(results[0].formatted_address);
						infowindow.open(map, marker);
					} else {
						window.alert('No results found');
					}
				} else {
					window.alert('Geocoder failed due to: ' + status);
				}
			});
		}
		function handleLocationError(browserHasGeolocation, infoWindow, pos) {
			infoWindow.setPosition(pos);
			infoWindow.setContent(browserHasGeolocation ?
				'Error: The Geolocation service failed.' :
				'Error: Your browser doesn\'t support geolocation.');
			infoWindow.open(map);
		}
	</script>
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAPPbs2Yz_oie_ldvKjEyG86ZUmh_PAdiY&callback=initMap"
	 async defer></script>
</body>

</html>
